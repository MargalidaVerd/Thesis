<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Margalida Verd Julià">

<title>TFG</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="TFG_files/libs/clipboard/clipboard.min.js"></script>
<script src="TFG_files/libs/quarto-html/quarto.js"></script>
<script src="TFG_files/libs/quarto-html/popper.min.js"></script>
<script src="TFG_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TFG_files/libs/quarto-html/anchor.min.js"></script>
<link href="TFG_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TFG_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TFG_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TFG_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TFG_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TFG</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Margalida Verd Julià </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="installing-data-and-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-data-and-packages">Installing data and packages</h2>
<p>First, we will install and load the necessary packages for this study. Additionally, we will load the required datasets. The analysis is based on three datasets:</p>
<ul>
<li><p><strong>Mortality</strong>: Downloaded from the World Health Organization, this is the primary dataset for the analysis. It contains the number of tuberculosis-related deaths in all countries. However, our study will focus solely on European countries.</p></li>
<li><p><strong>Population</strong>: From this dataset, we will extract only the population variable. The source of this data is <em>Our World in Data</em>.</p></li>
<li><p><strong>GDP per capita</strong>: Similar to the population dataset, we will extract only the <em>gdp_per_capita</em> variable. The source of this data is <em>Data Bank</em>.</p></li>
</ul>
<p>Let’s examine the structure of the datasets:</p>
<ol type="1">
<li>Mortality:</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,692
Columns: 12
$ Region.Code                                                 &lt;chr&gt; "EU", "EU"…
$ Region.Name                                                 &lt;chr&gt; "Europe", …
$ Country.Code                                                &lt;chr&gt; "ALB", "AL…
$ Country.Name                                                &lt;chr&gt; "Albania",…
$ Year                                                        &lt;dbl&gt; 1987, 1997…
$ Sex                                                         &lt;chr&gt; "All", "Al…
$ Age.group.code                                              &lt;chr&gt; "Age_all",…
$ Age.Group                                                   &lt;chr&gt; "[All]", "…
$ Number                                                      &lt;dbl&gt; 47, 19, 10…
$ Percentage.of.cause.specific.deaths.out.of.total.deaths     &lt;dbl&gt; 0.27126861…
$ Age.standardized.death.rate.per.100.000.standard.population &lt;dbl&gt; 2.2548644,…
$ Death.rate.per.100.000.population                           &lt;dbl&gt; 1.5279087,…</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Population</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18,944
Columns: 3
$ Entity                                                &lt;chr&gt; "Afghanistan", "…
$ Year                                                  &lt;int&gt; 1950, 1951, 1952…
$ Population...Sex..all...Age..all...Variant..estimates &lt;dbl&gt; 7776182, 7879343…</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>gdp_per_capita</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,629
Columns: 7
$ Series.Name  &lt;chr&gt; "GDP per capita (current US$)", "GDP per capita (current …
$ Series.Code  &lt;chr&gt; "NY.GDP.PCAP.CD", "NY.GDP.PCAP.CD", "NY.GDP.PCAP.CD", "NY…
$ Country.Name &lt;chr&gt; "Albania", "Albania", "Albania", "Albania", "Albania", "A…
$ Country.Code &lt;chr&gt; "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "…
$ Time         &lt;int&gt; 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 196…
$ Time.Code    &lt;chr&gt; "YR1960", "YR1961", "YR1962", "YR1963", "YR1964", "YR1965…
$ Value        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
</section>
<section id="cleaning-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-data">Cleaning data</h2>
<p>As seen, we need to standardize the variables names to merge the tables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mortality"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,692
Columns: 12
$ Region_Code      &lt;chr&gt; "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU",…
$ Region_Name      &lt;chr&gt; "Europe", "Europe", "Europe", "Europe", "Europe", "Eu…
$ Country_Code     &lt;chr&gt; "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB…
$ Country_Name     &lt;chr&gt; "Albania", "Albania", "Albania", "Albania", "Albania"…
$ Year             &lt;dbl&gt; 1987, 1997, 1996, 1996, 1995, 1994, 1994, 1994, 1993,…
$ Sex              &lt;chr&gt; "All", "All", "Female", "All", "Male", "Female", "Mal…
$ Age.group.code   &lt;chr&gt; "Age_all", "Age_all", "Age_all", "Age_all", "Age_all"…
$ Age.Group        &lt;chr&gt; "[All]", "[All]", "[All]", "[All]", "[All]", "[All]",…
$ Number_Deaths    &lt;dbl&gt; 47, 19, 10, 34, 10, 13, 26, 39, 12, 22, 15, 22, 19, 4…
$ Percent_CS_Death &lt;dbl&gt; 0.27126861, 0.11741441, 0.14432097, 0.20302144, 0.107…
$ Age_Death_Rate   &lt;dbl&gt; 2.2548644, 0.8057827, 0.7155687, 1.1585865, 0.7375924…
$ Death_Rate       &lt;dbl&gt; 1.5279087, 0.5715489, 0.6027727, 1.0356381, 0.6219679…</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Population"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18,944
Columns: 3
$ Country_Name &lt;chr&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan…
$ Year         &lt;int&gt; 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 195…
$ Population   &lt;dbl&gt; 7776182, 7879343, 7987783, 8096703, 8207953, 8326981, 845…</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gdp_per_capita"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,629
Columns: 4
$ Country_Name &lt;chr&gt; "Albania", "Albania", "Albania", "Albania", "Albania", "A…
$ Country_Code &lt;chr&gt; "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "…
$ Year         &lt;int&gt; 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 196…
$ GDP_capita   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<p>The next step is to select the variables of study of the mortality dataset. We will exclude <code>Sex</code>, <code>Age.group.code</code> and <code>Age.group</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,869
Columns: 9
$ Region_Code      &lt;chr&gt; "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU",…
$ Region_Name      &lt;chr&gt; "Europe", "Europe", "Europe", "Europe", "Europe", "Eu…
$ Country_Code     &lt;chr&gt; "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB…
$ Country_Name     &lt;chr&gt; "Albania", "Albania", "Albania", "Albania", "Albania"…
$ Year             &lt;dbl&gt; 1987, 1997, 1996, 1994, 1992, 1989, 1988, 1995, 1993,…
$ Number_Deaths    &lt;dbl&gt; 47, 19, 34, 39, 22, 41, 39, 17, 34, 21, 16, 8, 7, 9, …
$ Percent_CS_Death &lt;dbl&gt; 0.27126861, 0.11741441, 0.20302144, 0.26027763, 0.127…
$ Age_Death_Rate   &lt;dbl&gt; 2.2548644, 0.8057827, 1.1585865, 1.5472763, 0.9103631…
$ Death_Rate       &lt;dbl&gt; 1.5279087, 0.5715489, 1.0356381, 1.2179888, 0.6896336…</code></pre>
</div>
</div>
<p>Now, we can join the other two datasets:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,998
Columns: 11
$ Region_Code      &lt;chr&gt; "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU", "EU",…
$ Region_Name      &lt;chr&gt; "Europe", "Europe", "Europe", "Europe", "Europe", "Eu…
$ Country_Code     &lt;chr&gt; "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB", "ALB…
$ Country_Name     &lt;chr&gt; "Albania", "Albania", "Albania", "Albania", "Albania"…
$ Year             &lt;dbl&gt; 1987, 1997, 1996, 1994, 1992, 1989, 1988, 1995, 1993,…
$ Number_Deaths    &lt;dbl&gt; 47, 19, 34, 39, 22, 41, 39, 17, 34, 21, 16, 8, 7, 9, …
$ Percent_CS_Death &lt;dbl&gt; 0.27126861, 0.11741441, 0.20302144, 0.26027763, 0.127…
$ Age_Death_Rate   &lt;dbl&gt; 2.2548644, 0.8057827, 1.1585865, 1.5472763, 0.9103631…
$ Death_Rate       &lt;dbl&gt; 1.5279087, 0.5715489, 1.0356381, 1.2179888, 0.6896336…
$ Population       &lt;dbl&gt; 3148843, 3229665, 3245681, 3269417, 3282506, 3260370,…
$ GDP_capita       &lt;dbl&gt; 674.7934, 717.3800, 1009.9771, 586.4161, 200.8522, 69…</code></pre>
</div>
</div>
</section>
<section id="chosen-countries" class="level2">
<h2 class="anchored" data-anchor-id="chosen-countries">Chosen countries</h2>
<p>First, we will define the criteria for dividing European countries into six distinct regions: North, South, West, East, Central, and the Balkans. The Balkans have been designated as a separate region due to their significant cultural differences from neighboring countries. We will add a new variable to the dataset that specifies the subregion to which each country belongs.</p>
<p>The map below shows the division that would be used from this point forward.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We are considering Greece as part of the Southern region due to the cultural differences with the Balkan countries. Now, we would choose a country to represent each European subregion. We will select five European countries to analyze their trends in the number of tuberculosis-related deaths. The selection criteria will ensure that the chosen countries represent different regions of Europe (e.g., North, South, etc.) while also having a sufficient number of time observations to construct a reliable time series. Additionally, we aim to include countries that exhibit distinct trends in tuberculosis mortality, making the study more insightful by allowing for a comparative analysis and accurate forecasting of different patterns.</p>
<p>As a first step, we will address any missing values (NA) in the dataset for the variable Number_Deaths in each selected country. We are going to choose countries that at least have 40 years with data.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                                           Country_Name  n
1                                           Netherlands 73
2                                               Iceland 72
3                                                Sweden 72
4                                               Denmark 71
5                                                France 71
6                                               Ireland 71
7                                                 Spain 71
8                                           Switzerland 71
9  United Kingdom of Great Britain and Northern Ireland 71
10                                              Finland 70
11                                                Italy 70
12                                              Hungary 68
13                                              Austria 67
14                                              Belgium 67
15                                               Norway 66
16                                             Portugal 62
17                                               Poland 61
18                                               Greece 60
19                                              Romania 60
20                                             Bulgaria 58
21                                           Luxembourg 56
22                                                Malta 55
23                                               Latvia 42
24                                              Estonia 40
25                                            Lithuania 40
26                                   Russian Federation 40</code></pre>
</div>
</div>
<p>Lets study each subregion:</p>
<ul>
<li><p><strong>Southern Europe</strong>. Due to the geographical origin of the authors, we will choose Spain as the representative country of this region.</p></li>
<li><p><strong>Northern Europe</strong>. We observe that Iceland has 72 out of 74 years with recorded values for the selected variable, making it a suitable choice to represent the North region of Europe.</p></li>
<li><p><strong>Western Europe</strong>. As Netherlands is the country with a greatest number of values, it would be our choice for this specific region.</p></li>
<li><p><strong>Eastern Europe</strong>. It is noticeable that eastern countries are the ones with a less number of recorded values (most of them have only 40 or less); then, it would be a special region to analyse. Lithuania will represent the Northeast region, with 40 recorded values. Even though there are nearby countries with longer recorded periods, the tendency of Lithuania stands out among the rest, which will make for an interesting analysis.</p></li>
<li><p><strong>Central Europe</strong>. Switzerland will be the representative country of the central region. It has 71 recorded values, that will fit perfectly when modeling the time series.</p></li>
<li><p><strong>Balkans region</strong>. For the Balkans region, we have selected Romania, which has 60 recorded values. It will be an interesting case of analysis due to its tendency, that is a bit different as the other countries.</p></li>
</ul>
<p>The selection criteria prioritize minimizing the number of missing values (NA) while ensuring a diverse representation of different regions in Europe. As we have discussed trends, let’s display the trend in tuberculosis-related deaths for the selected countries.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="detrending-series" class="level2">
<h2 class="anchored" data-anchor-id="detrending-series">Detrending series</h2>
<p>As we saw in the previous section, developed countries exhibit a noticeable downward trend. To apply an ARIMA model, it is essential to work with a stationary time series, meaning data should not have any trend. The goal now is to detrend those series (Spain, Iceland, Netherlands and Switzerland).</p>
<p>$The following regression model was applied:</p>
<p><span class="math display">\[\ln(Number\_Deaths)= \ln(\beta_0)-\beta_1 \cdot \text{Year} + \ln(u_t),\]</span> where <span class="math inline">\(u_t\)</span> represents the residuals term. We will use the function <code>lm</code> for the regression. We begin our study with Spain data. The estimated coefficients are as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Number_Deaths) ~ Year, data = spain_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.32585 -0.10357 -0.00696  0.10779  0.74253 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.316e+02  1.984e+00   66.29   &lt;2e-16 ***
Year        -6.260e-02  9.992e-04  -62.65   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1725 on 69 degrees of freedom
Multiple R-squared:  0.9827,    Adjusted R-squared:  0.9825 
F-statistic:  3925 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Intercept: p-value &lt; <span class="math inline">\(2.2e-16\)</span> indicates it is a significant baseline value.</li>
<li>Year coefficient <span class="math inline">\(\beta_1\)</span>: p-value &lt; <span class="math inline">\(2.2e-16\)</span> suggests a statistically significant decreasing trend in tuberculosis mortality over time.</li>
</ul>
<p>Notice that the model’s high <span class="math inline">\(R\)</span>-squared value indicates that the linear trend explains approximately the <span class="math inline">\(98.3\%\)</span> of the variace in the logarithm data, confirming a strong fit.</p>
<p>Now, we plot the residuals of the serie.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Upon examining the residuals plot of the linear regression model, it becomes evident that the residuals do not follow a normal distribution. This deviation suggests that the model has not fully captured the underlying patterns of the data, and there may still be some autocorrelation or temporal dependencies present in the residuals.</p>
<p>To further investigate this, we will plot the autocorrelation function (ACF) and partial autocorrelation function (PACF) of the residuals. These plots will help us determine whether there are any significant correlations at specific lags, indicating the presence of autocorrelation that was not accounted for in the linear regression model.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The PACF plot reveals that the first lag is significantly different from zero, indicating that there is a strong correlation between the residual at time <span class="math inline">\(t\)</span> and the residual at time <span class="math inline">\(t−1\)</span>. This suggests that the residuals exhibit autocorrelation at this lag, meaning that the error at one time point is related to the error at the previous time point.</p>
<p>We are going to adjust an ARIMA model to the residuals using the <code>auto.arima</code> function.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: residSpain 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.5211
s.e.   0.1068

sigma^2 = 0.0123:  log likelihood = 54.95
AIC=-105.89   AICc=-105.71   BIC=-101.39</code></pre>
</div>
</div>
<p>We can model the Spain data residuals with an ARIMA of order <span class="math inline">\((0,1,1)\)</span>. So, the regression for Spain time serie is as follows:</p>
<p><span class="math display">\[\ln(Number\_Deaths) = \ln(\beta_0)-\beta_1 \cdot \text{Year} + \ln(u_t),\]</span> where <span class="math inline">\(z_t= \ln(u_t)\)</span> follows an ARIMA(0,1,1).</p>
<p>We can do the same for the remaining countries.</p>
<p><em>Netherlands</em></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Number_Deaths) ~ Year, data = netherlands_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.71038 -0.25783  0.01511  0.23108  1.00862 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 95.169420   3.930556   24.21   &lt;2e-16 ***
Year        -0.045445   0.001979  -22.96   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3563 on 71 degrees of freedom
Multiple R-squared:  0.8813,    Adjusted R-squared:  0.8797 
F-statistic: 527.3 on 1 and 71 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: residNeth 
ARIMA(1,0,1) with zero mean 

Coefficients:
         ar1      ma1
      0.9567  -0.5216
s.e.  0.0414   0.0899

sigma^2 = 0.056:  log likelihood = 1.94
AIC=2.13   AICc=2.47   BIC=9</code></pre>
</div>
</div>
<p><em>Switzerland</em></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(Number_Deaths) ~ Year, data = switzerland_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46064 -0.08186  0.01186  0.11527  0.56928 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 141.242374   2.127645   66.38   &lt;2e-16 ***
Year         -0.068699   0.001071  -64.13   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.185 on 69 degrees of freedom
Multiple R-squared:  0.9835,    Adjusted R-squared:  0.9833 
F-statistic:  4112 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Residus de Switzerland no tenen correlacio</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Iceland</em></p>
<p>PROBLEMA: No podem aplicar log a Iceland perque te valors de ND = 0.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Number_Deaths ~ Year, data = iceland_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.1330 -2.2551 -0.3631  0.9195 22.6111 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 253.40884   43.71728   5.797 1.78e-07 ***
Year         -0.12559    0.02201  -5.707 2.56e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.881 on 70 degrees of freedom
Multiple R-squared:  0.3175,    Adjusted R-squared:  0.3078 
F-statistic: 32.57 on 1 and 70 DF,  p-value: 2.557e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="autocorrelation-functions" class="level2">
<h2 class="anchored" data-anchor-id="autocorrelation-functions">Autocorrelation functions</h2>
<p>Autocorrelation measures the linear relationship between lagged values of a time series.</p>
<p>The autocorrelation function tells us the correlation between observations and those that came before them, separated by different lags (forecasting: principles and practice). - When data have a trend, the acutocorrelations for small lags tend to be large and positive, as it is our case.</p>
</section>
<section id="pacf-functions" class="level2">
<h2 class="anchored" data-anchor-id="pacf-functions">PACF functions</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="time-series-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="time-series-decomposition">Time series decomposition</h2>
<p>If we assume an additive decomposition, then we can write <span class="math display">\[y_t = S_t +T_t +R_t,\]</span> where <span class="math inline">\(y_t\)</span> is the data, <span class="math inline">\(S_t\)</span> is the seasonal component, <span class="math inline">\(T_t\)</span> is the trend-cycle component and <span class="math inline">\(R_t\)</span> is the remainder component, all at period <span class="math inline">\(t\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="non-seasonal-arima-models" class="level2">
<h2 class="anchored" data-anchor-id="non-seasonal-arima-models">Non-seasonal ARIMA models</h2>
<p>ARIMA(p,d,q) model where:</p>
<ul>
<li>p is the order of the AR part</li>
<li>q is the degree of first differencing involved</li>
<li>q is the order of the moving average part</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: Number_Deaths 
Model: ARIMA(1,2,0) 

Coefficients:
         ar1
      0.8512
s.e.  0.1289

sigma^2 estimated as 533641:  log likelihood=-553.01
AIC=1110.03   AICc=1110.21   BIC=1114.49</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TFG_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>